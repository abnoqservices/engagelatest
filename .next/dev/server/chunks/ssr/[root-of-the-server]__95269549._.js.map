{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/D/next/engage33/app/preview/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/preview/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/preview/page.tsx <module evaluation>\",\n    \"default\",\n);\nexport const dynamic = registerClientReference(\n    function() { throw new Error(\"Attempted to call dynamic() from the server but dynamic is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/preview/page.tsx <module evaluation>\",\n    \"dynamic\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAwR,GACrT,sDACA;AAEG,MAAM,UAAU,IAAA,wQAAuB,EAC1C;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,sDACA","ignoreList":[0]}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/D/next/engage33/app/preview/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/preview/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/preview/page.tsx\",\n    \"default\",\n);\nexport const dynamic = registerClientReference(\n    function() { throw new Error(\"Attempted to call dynamic() from the server but dynamic is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/preview/page.tsx\",\n    \"dynamic\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAoQ,GACjS,kCACA;AAEG,MAAM,UAAU,IAAA,wQAAuB,EAC1C;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,kCACA","ignoreList":[0]}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/D/next/engage33/lib/axiosClient.ts"],"sourcesContent":["import axios from \"axios\";\n\nconst axiosClient = axios.create({\n  baseURL: process.env.NEXT_PUBLIC_API_URL,\n  headers: {\n    Accept: \"application/json\",\n  },\n});\n\n//  Attach token to every request\naxiosClient.interceptors.request.use((config) => {\n  if (typeof window !== \"undefined\") {\n    const token = localStorage.getItem(\"token\"); //  MUST be \"token\"\n\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n  }\n\n  return config;\n});\nexport default axiosClient;\n//  Auto logout on 401 (important)\n// axiosClient.interceptors.response.use(\n//   (response) => response,\n//   (error) => {\n//     if (error.response?.status === 401) {\n//       localStorage.removeItem(\"token\");\n//       localStorage.removeItem(\"user\");\n//       window.location.href = \"/signin\";\n//     }\n\n//     return Promise.reject(error);\n//   }\n// );\n\n\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,gJAAK,CAAC,MAAM,CAAC;IAC/B,OAAO;IACP,SAAS;QACP,QAAQ;IACV;AACF;AAEA,iCAAiC;AACjC,YAAY,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IACpC;;IAQA,OAAO;AACT;uCACe;CACf,kCAAkC;CAClC,yCAAyC;CACzC,4BAA4B;CAC5B,iBAAiB;CACjB,4CAA4C;CAC5C,0CAA0C;CAC1C,yCAAyC;CACzC,0CAA0C;CAC1C,QAAQ;CAER,oCAAoC;CACpC,MAAM;CACN,KAAK"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/D/next/engage33/app/preview/layout.tsx"],"sourcesContent":["// app/preview/[productId]/page.tsx\n\nimport Preview from \"@/app/preview/page\";\nimport axiosClient from \"@/lib/axiosClient\"; // Use public instance\n\ninterface Section {\n  id: number;\n  content: any;\n  is_published: boolean;\n  sort_order: number;\n  global_section: {\n    key: string;\n    name: string;\n    schema?: any;\n  };\n}\n\ninterface ApiResponse {\n  success: boolean;\n  data: {\n    product_id: number;\n    sections: Section[];\n  };\n}\n\nfunction transformApiData(apiData: ApiResponse[\"data\"]): {\n  templateName: string;\n  sections: Array<{\n    sectionId: number;\n    sectionKey: string;\n    label: string;\n    enabled: boolean;\n    content: any;\n    schema?: any;\n  }>;\n} {\n  const activeSections = apiData.sections\n    .filter((s) => s.is_published)\n    .sort((a, b) => a.sort_order - b.sort_order)\n    .map((sec) => ({\n      sectionId: sec.id,\n      sectionKey: sec.global_section.key,\n      label: sec.global_section.name,\n      enabled: sec.is_published,\n      content: sec.content || {},\n      schema: sec.global_section.schema,\n    }));\n\n  return {\n    templateName: \"modern\",\n    sections: activeSections,\n  };\n}\n\nexport default async function PreviewPage({\n  params,\n}: {\n  params: { productId: string };\n}) {\n  // Use dynamic productId from URL, or fallback to hardcoded for testing\n  const productId = 32;\n\n  let previewData = null;\n  let error: string | null = null;\n\n  try {\n    // Direct API call using public axios (no auth token)\n    const response = await axiosClient.get(`/products/${productId}/landing-page`);\n\n    const json = response.data;\n      console.log(\"Fetched preview data:\", json);\n    if (json.success && json.data?.sections) {\n      previewData = transformApiData(json.data);\n    } else {\n      error = \"No landing page data found for this product\";\n    }\n  } catch (err: any) {\n    console.error(\"Error fetching preview data:\", err);\n\n    if (err.response) {\n      const status = err.response.status;\n      if (status === 404) {\n        error = \"Product or landing page not found\";\n      } else if (status === 401) {\n        error = \"Unauthorized access to preview (auth required)\";\n      } else {\n        error = `API error: ${status} - ${err.response.data?.message || \"Unknown\"}`;\n      }\n    } else if (err.request) {\n      error = \"Unable to reach server\";\n    } else {\n      error = \"Failed to load preview data\";\n    }\n  }\n\n  // Error UI\n//   if (error || !previewData) {\n//     return (\n//       <div className=\"flex min-h-screen items-center justify-center bg-gray-50\">\n//         <div className=\"text-center p-8\">\n//           <h1 className=\"text-3xl font-bold text-red-600 mb-4\">Preview Unavailable</h1>\n//           <p className=\"text-lg text-gray-700\">{error || \"No preview data available\"}</p>\n//           <p className=\"mt-4 text-sm text-gray-500\">Product ID: {productId}</p>\n//         </div>\n//       </div>\n//     );\n//   }\n\n  // Success: Pass transformed data to Preview component\n  return (\n    <main className=\"min-h-screen\">\n      <Preview data={previewData} productId={productId} />\n    </main>\n  );\n}"],"names":[],"mappings":"AAAA,mCAAmC;;;;;;AAEnC;AACA,yMAA6C,sBAAsB;;;;AAsBnE,SAAS,iBAAiB,OAA4B;IAWpD,MAAM,iBAAiB,QAAQ,QAAQ,CACpC,MAAM,CAAC,CAAC,IAAM,EAAE,YAAY,EAC5B,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,UAAU,GAAG,EAAE,UAAU,EAC1C,GAAG,CAAC,CAAC,MAAQ,CAAC;YACb,WAAW,IAAI,EAAE;YACjB,YAAY,IAAI,cAAc,CAAC,GAAG;YAClC,OAAO,IAAI,cAAc,CAAC,IAAI;YAC9B,SAAS,IAAI,YAAY;YACzB,SAAS,IAAI,OAAO,IAAI,CAAC;YACzB,QAAQ,IAAI,cAAc,CAAC,MAAM;QACnC,CAAC;IAEH,OAAO;QACL,cAAc;QACd,UAAU;IACZ;AACF;AAEe,eAAe,YAAY,EACxC,MAAM,EAGP;IACC,uEAAuE;IACvE,MAAM,YAAY;IAElB,IAAI,cAAc;IAClB,IAAI,QAAuB;IAE3B,IAAI;QACF,qDAAqD;QACrD,MAAM,WAAW,MAAM,6HAAW,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,UAAU,aAAa,CAAC;QAE5E,MAAM,OAAO,SAAS,IAAI;QACxB,QAAQ,GAAG,CAAC,yBAAyB;QACvC,IAAI,KAAK,OAAO,IAAI,KAAK,IAAI,EAAE,UAAU;YACvC,cAAc,iBAAiB,KAAK,IAAI;QAC1C,OAAO;YACL,QAAQ;QACV;IACF,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,gCAAgC;QAE9C,IAAI,IAAI,QAAQ,EAAE;YAChB,MAAM,SAAS,IAAI,QAAQ,CAAC,MAAM;YAClC,IAAI,WAAW,KAAK;gBAClB,QAAQ;YACV,OAAO,IAAI,WAAW,KAAK;gBACzB,QAAQ;YACV,OAAO;gBACL,QAAQ,CAAC,WAAW,EAAE,OAAO,GAAG,EAAE,IAAI,QAAQ,CAAC,IAAI,EAAE,WAAW,WAAW;YAC7E;QACF,OAAO,IAAI,IAAI,OAAO,EAAE;YACtB,QAAQ;QACV,OAAO;YACL,QAAQ;QACV;IACF;IAEA,WAAW;IACb,iCAAiC;IACjC,eAAe;IACf,mFAAmF;IACnF,4CAA4C;IAC5C,0FAA0F;IAC1F,4FAA4F;IAC5F,kFAAkF;IAClF,iBAAiB;IACjB,eAAe;IACf,SAAS;IACT,MAAM;IAEJ,sDAAsD;IACtD,qBACE,8OAAC;QAAK,WAAU;kBACd,cAAA,8OAAC,kIAAO;YAAC,MAAM;YAAa,WAAW;;;;;;;;;;;AAG7C"}}]
}