{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/D/next/engage333/app/api/qr/route.ts"],"sourcesContent":["export const runtime = \"nodejs\";\n\nimport { NextRequest, NextResponse } from \"next/server\";\nimport QRCodeStyling from \"qr-code-styling\";\n\nimport { createCanvas } from \"canvas\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nconst getQrOptions = (data: string) => ({\n  width: 400,\n  height: 400,\n  data,\n  margin: 5,\n  type: \"png\" as const,\n  qrOptions: { errorCorrectionLevel: \"H\" },\n  dotsOptions: {\n    type: \"rounded\",\n    color: \"#000000\",\n  },\n  backgroundOptions: { color: \"#ffffff\" },\n});\n\nexport async function POST(req: NextRequest) {\n  try {\n    const { baseUrl } = await req.json();\n\n    if (!baseUrl || typeof baseUrl !== \"string\") {\n      return NextResponse.json(\n        { error: \"baseUrl is required and must be a string\" },\n        { status: 400 }\n      );\n    }\n\n    const productId = uuidv4();\n    const qrTargetUrl = `${baseUrl}/${productId}`;\n\n    // Required for qr-code-styling in Node\n  \n\n    const qr = new QRCodeStyling({\n      ...getQrOptions(qrTargetUrl),\n      nodeCanvas: createCanvas,\n    });\n\n    const buffer = await qr.getRawData(\"png\");\n    const base64 = Buffer.from(buffer).toString(\"base64\");\n\n    return NextResponse.json({\n      success: true,\n      productId,\n      qrTargetUrl,\n      qrImageBase64: `data:image/png;base64,${base64}`,\n    });\n  } catch (err: any) {\n    console.error(\"QR generation error:\", err);\n\n    return NextResponse.json(\n      {\n        error: \"Failed to generate QR code\",\n        details: err?.message ?? \"Unknown error\",\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAEA;AACA;AANO,MAAM,UAAU;;;;;AAQvB,MAAM,eAAe,CAAC,OAAiB,CAAC;QACtC,OAAO;QACP,QAAQ;QACR;QACA,QAAQ;QACR,MAAM;QACN,WAAW;YAAE,sBAAsB;QAAI;QACvC,aAAa;YACX,MAAM;YACN,OAAO;QACT;QACA,mBAAmB;YAAE,OAAO;QAAU;IACxC,CAAC;AAEM,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAElC,IAAI,CAAC,WAAW,OAAO,YAAY,UAAU;YAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA2C,GACpD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,YAAY,IAAA,mLAAM;QACxB,MAAM,cAAc,GAAG,QAAQ,CAAC,EAAE,WAAW;QAE7C,uCAAuC;QAGvC,MAAM,KAAK,IAAI,kLAAa,CAAC;YAC3B,GAAG,aAAa,YAAY;YAC5B,YAAY,qHAAY;QAC1B;QAEA,MAAM,SAAS,MAAM,GAAG,UAAU,CAAC;QACnC,MAAM,SAAS,OAAO,IAAI,CAAC,QAAQ,QAAQ,CAAC;QAE5C,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT;YACA;YACA,eAAe,CAAC,sBAAsB,EAAE,QAAQ;QAClD;IACF,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,wBAAwB;QAEtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,KAAK,WAAW;QAC3B,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}