{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/D/next/engage333/lib/axiosClient.ts"],"sourcesContent":["import axios from \"axios\";\n\nconst axiosClient = axios.create({\n  baseURL: process.env.NEXT_PUBLIC_API_URL,\n  headers: {\n    Accept: \"application/json\",\n  },\n});\n\n//  Attach token to every request\naxiosClient.interceptors.request.use((config) => {\n  if (typeof window !== \"undefined\") {\n    const token = localStorage.getItem(\"token\"); //  MUST be \"token\"\n\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n  }\n\n  return config;\n});\nexport default axiosClient;\n//  Auto logout on 401 (important)\n// axiosClient.interceptors.response.use(\n//   (response) => response,\n//   (error) => {\n//     if (error.response?.status === 401) {\n//       localStorage.removeItem(\"token\");\n//       localStorage.removeItem(\"user\");\n//       window.location.href = \"/signin\";\n//     }\n\n//     return Promise.reject(error);\n//   }\n// );\n\n\n"],"names":[],"mappings":";;;;AAGW;AAHX;;AAEA,MAAM,cAAc,mJAAK,CAAC,MAAM,CAAC;IAC/B,OAAO;IACP,SAAS;QACP,QAAQ;IACV;AACF;AAEA,iCAAiC;AACjC,YAAY,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IACpC,wCAAmC;QACjC,MAAM,QAAQ,aAAa,OAAO,CAAC,UAAU,mBAAmB;QAEhE,IAAI,OAAO;YACT,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;QAClD;IACF;IAEA,OAAO;AACT;uCACe;;;;CACf,kCAAkC;CAClC,yCAAyC;CACzC,4BAA4B;CAC5B,iBAAiB;CACjB,4CAA4C;CAC5C,0CAA0C;CAC1C,yCAAyC;CACzC,0CAA0C;CAC1C,QAAQ;CAER,oCAAoC;CACpC,MAAM;CACN,KAAK"}},
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/D/next/engage333/lib/showToast.ts"],"sourcesContent":["import { toast } from \"sonner\";\n\ntype ToastType = \"success\" | \"error\" | \"info\" | \"warning\";\n\nexport const showToast = (message: string, type: ToastType = \"success\") => {\n  switch (type) {\n    case \"success\":\n      toast.success(message);\n      break;\n\n    case \"error\":\n      toast.error(message);\n      break;\n\n    case \"info\":\n      toast(message);\n      break;\n\n    case \"warning\":\n      toast.warning(message);\n      break;\n\n    default:\n      toast(message);\n  }\n};\n"],"names":[],"mappings":";;;;AAAA;;AAIO,MAAM,YAAY,CAAC,SAAiB,OAAkB,SAAS;IACpE,OAAQ;QACN,KAAK;YACH,oJAAK,CAAC,OAAO,CAAC;YACd;QAEF,KAAK;YACH,oJAAK,CAAC,KAAK,CAAC;YACZ;QAEF,KAAK;YACH,IAAA,oJAAK,EAAC;YACN;QAEF,KAAK;YACH,oJAAK,CAAC,OAAO,CAAC;YACd;QAEF;YACE,IAAA,oJAAK,EAAC;IACV;AACF"}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/D/next/engage333/app/customers/create/page.tsx"],"sourcesContent":["// app/dashboard/contacts/import/page.tsx\n'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport Papa from 'papaparse'           // ← install if needed: npm i papaparse @types/papaparse\nimport axiosClient from '@/lib/axiosClient'\nimport { showToast } from '@/lib/showToast'\n\n// ... shadcn/ui imports ...\n\nexport default function BulkImportContactsPage() {\n  const router = useRouter()\n  const [file, setFile] = useState<File | null>(null)\n  const [parsedRows, setParsedRows] = useState<any[]>([])\n  const [mapping, setMapping] = useState<Record<string, string>>({})\n  const [importSource, setImportSource] = useState('csv_import')\n  const [deduplicate, setDeduplicate] = useState(true)\n  const [isImporting, setIsImporting] = useState(false)\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const selected = e.target.files?.[0]\n    if (!selected?.name.endsWith('.csv')) {\n      showToast('Please upload a .csv file', 'error')\n      return\n    }\n    setFile(selected)\n\n    Papa.parse(selected, {\n      header: true,\n      skipEmptyLines: true,\n      complete: (result) => {\n        setParsedRows(result.data.slice(0, 10)) // preview first 10\n        // auto-suggest mapping based on headers\n        const headers = result.meta.fields || []\n        const initialMapping: Record<string, string> = {}\n        headers.forEach(h => {\n          const lower = h.toLowerCase()\n          if (lower.includes('first') || lower.includes('fname')) initialMapping[h] = 'first_name'\n          if (lower.includes('last')  || lower.includes('lname')) initialMapping[h] = 'last_name'\n          if (lower.includes('email')) initialMapping[h] = 'email'\n          if (lower.includes('phone')) initialMapping[h] = 'phone'\n          if (lower.includes('company')) initialMapping[h] = 'company'\n        })\n        setMapping(initialMapping)\n      }\n    })\n  }\n\n  const handleImport = async () => {\n    if (!file || parsedRows.length === 0) return\n\n    setIsImporting(true)\n\n    // In real app: send file to backend or parse & send batch\n    // Here we show example sending one-by-one (not ideal — prefer bulk endpoint)\n\n    try {\n      // Option A: If backend supports bulk → send array\n      // const contacts = parsedRows.map(row => mapToContact(row, mapping, importSource))\n      // await axiosClient.post('/contacts/bulk', { contacts, deduplicate })\n\n      // Option B: loop (safer for now)\n      let successCount = 0\n      for (const row of parsedRows) {\n        const contact = {\n          first_name: row[mapping.first_name] || '',\n          last_name: row[mapping.last_name] || '',\n          email: row[mapping.email]?.trim(),\n          phone: row[mapping.phone]?.trim(),\n          company: row[mapping.company]?.trim(),\n          contact_type: 'manual_bulk_import',\n          contact_source: importSource,\n          deduplicate,\n          // source_metadata: { imported_from: file.name, imported_at: new Date().toISOString() }\n        }\n\n        try {\n          await axiosClient.post('/contacts', contact)\n          successCount++\n        } catch (err: any) {\n          if (err.response?.status === 409) {\n            // skipped duplicate\n          } else {\n            console.warn('Import row failed:', row, err)\n          }\n        }\n      }\n\n      showToast(`Imported ${successCount} contacts successfully`, 'success')\n      router.push('/dashboard/contacts')\n\n    } catch (err) {\n      showToast('Bulk import failed', 'error')\n    } finally {\n      setIsImporting(false)\n    }\n  }\n\n  return (\n    <div className=\"container py-10\">\n      <Card>\n        <CardHeader>\n          <CardTitle>Import Contacts</CardTitle>\n          <CardDescription>\n            Upload CSV file • Bulk creation with origin tracking\n          </CardDescription>\n        </CardHeader>\n\n        <CardContent className=\"space-y-6\">\n          {/* File upload */}\n          <div>\n            <label className=\"block text-sm font-medium\">Upload CSV</label>\n            <Input type=\"file\" accept=\".csv\" onChange={handleFileChange} />\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Expected columns: first_name, last_name, email, phone, company, ...\n            </p>\n          </div>\n\n          {/* Source selection */}\n          <div>\n            <label className=\"block text-sm font-medium\">Import Source</label>\n            <Select value={importSource} onValueChange={setImportSource}>\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"csv_import\">CSV Import (via dashboard)</SelectItem>\n                <SelectItem value=\"zapier\">Zapier Integration</SelectItem>\n                <SelectItem value=\"api\">API / External System</SelectItem>\n                {/* Add more if you expose them */}\n              </SelectContent>\n            </Select>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Will be stored as contact_source (immutable)\n            </p>\n          </div>\n\n          {/* Deduplicate toggle */}\n          <div className=\"flex items-center space-x-2\">\n            <Switch id=\"dedup\" checked={deduplicate} onCheckedChange={setDeduplicate} />\n            <label htmlFor=\"dedup\" className=\"text-sm font-medium\">\n              Skip duplicates (email/phone)\n            </label>\n          </div>\n\n          {/* Preview + mapping UI would go here */}\n\n          <Button onClick={handleImport} disabled={!file || isImporting}>\n            {isImporting ? 'Importing...' : 'Start Import'}\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}"],"names":[],"mappings":"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"}}]
}